---
title: "MEE-19-10-743 Shifting spaces: which disparity or dissimilarity metrics best summarise occupancy in multidimensional spaces?"
author: "Thomas Guillerme, Mark N. Puttick, Ariel E. Marcy, Vera Weisbecker"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_width: 8
    fig_height: 8
---

Dear Editor,

@@please find below our detailed response to the reviewers comments. For clarity, the reviewer's comments are in <font style="color:blue">blue</font> and our response in black with the modified text in the manuscript in *italic*.
We've provided a version of the manuscript where the changes are highlighted in <font style="color:blue">blue</font>.


# Associate Editor Comments to Author:

* <p style="color:blue">[...]The main problem pointed out by the second reviewer is that the manuscript suffers from a lack of accuracy and clarity in the use of mathematical terminology. I share this concern. I fact I found the manuscript difficult to follow at any level of detail. After reading I was left with little added understanding of what the different measures are supposed to measure or how they perform in these goals. For example, I did not understand the results in the seemingly central Table 5, and like the reviewers I found many mathematical statements to be odd or nonsensical. [...] The topic is certainly appropriate, but a revised manuscript must be substantially improved in mathematical clarity and rigor. The motivation and goals of the measures must be clearly laid out and evaluated. [...]</p>

# Reviewer: 1

<p style="color:blue">In terms of potential modifications to the paper I would actually urge the authors to remove some material rather than add more. Specifically the paper entertains the notion (e.g., L281) that there might be a "magic bullet" metric that captures all three types of measure and that any metric could be applied to capture any of the three types of distribution. This seems a priori to be foolish. For example, sum of ranges could not reasonably be expected to capture density as it does not consider values between the edges (ranges) on any given axis. Similarly, if all points in a distribution were shifted exactly ten units in a specific direction then sum of ranges would remain identical. Thus this is clearly only ever going to be reasonably applied as a volume metric. One could also say something similar for nearest neighbor measures, which logically capture density, but would make no sense as a volume or position metric.</p>

> On line 281, we did actually insist that there is "that there is no perfect one-size-fit all", we have now changed it to "there **can be** no perfect one-size-fit all metric" to highlight that we, like the reviewer agree that finding a "magic bullet" is foolish.

<p style="color:blue">I thus think lumping all metrics into a single "pot" of analyses is both a waste of time and more likely to lead to confusion on the part of the reader. </p>

> @@@ need to make sure this is clear throughout the manuscript


<p style="color:blue">This is especially true of the graphing (i.e., Figure 2E) where the "ideal" scenario will vary depending on the type of measure intended. Currently this makes Table 5 harder to understand than is necessary. Indeed, I would wager that the authors came up with their novel position metric purely because they realised none of the other metrics are logically intended to do this job. I thus suggest a priori defining each metric as a volume, density or position metric and showing only the tests for each in the main text (alongside the ideal plot for a metric that captures that feature well). In other words, sum of ranges would only appear in the volume tests and nearest neighbour only in the density tests. The full results can be moved to the SI, but I think Figure 3 already captures the fact that these metrics measure very different things for the most part (very few show strong positive correlation), as we would logically expect.</p>

> We clarified the Figure 2 to show the "ideal" scenario for any type of metric with two panels showing the best and worst scenarios for any metrics. We did not however separated the Table 5 for each different aspect (size, position, density) since we wanted this table to illustrate how different metrics can capture different aspects at different degrees. For example, the Average distance from centroid (row 1 Table 5) captures changes in size fairly well (column 1) but can also be influenced by changes in density (column 2). Thus changes in the Average distance from centroid are likely to correspond to changes in the size of the trait space but could also be due to changes in density of the trait space (though not likely due to a change in position of the trait space). We added the following to the Table 5 caption to make it clearer:

*This figure illustrates how different metrics can be influenced by different aspects of changes in the trait space. For example, the Average distance from centroid (row 1) captures mainly changes in size (column 1), but also captures changes in density (column 2) but does not capture changes in position (column 3).* @@@lines


<p style="color:blue">Aside from this, the only potentially fatal flaw in the paper is that it seems to assume features about the spaces that may not be true. For example, that they are Euclidean (distances in the space reflect true distances between points) and isotropic (it is as easy to traverse the space in any direction). E.g., if the latter is not true then distance based measures (nearest neighbor and minimum spanning trees) are confounded. Similarly, if spaces are anisotropic then position based measures may be confounded. </p>

> We've added a disclaimer specifying that the metrics presented here work for Euclidean isotropic spaces:

*Note that these metrics are specific to trait-spaces that are Euclidean (distances in the space reflect true distances between points) and isotropic (it is as easy to traverse the space in any direction).* lines@@@

<p style="color:blue">Additionally, the authors use the term "occupancy" many times, but I do not think they ever really consider occupancy in the truest sense, as this would require knowing how much of the space is truly /occupiable/. For example, where are the true limits of a space (i.e., the "edges")? And are all points inside those limits realistically occupiable? Note that these are simply hard problems, and the authors do already consider other aspects of empirical spaces such as total number of dimensions and distributions of variance across axes. However, I think they could go further in making it clear to readers that these issues must be considered. A nice example of how this could be done was shown by Hillis et al. (2005; Systematic Biology, 54, 471–482). Their Figure 10 shows how ordinations can drastically distort distances. Otherwise, I simply think the authors need to state these issues plainly to help guide readers in their metric choice.</p>

>We thank the reviewer for point out this really interesting aspect and we have added the following disclaimer around the term "occupancy":

*Note that we refer to occupancy here as the general term for where observations are in a trait space.
This definition excludes whether spaces are are truly "occupiable" (e.g. are there limits to the space, are some regions of the space inapplicable, etc.) which might be of importance in particulare spaces (e.g. in tree spaces; @Hillis2005).* lines@@@


<p style="color:blue">(I would also note that the authors currently post several questions that their metrics do not really answer, i.e., L47-48 "are groups overlapping in the trait-space? Are some regions of the trait-space not occupied? How do specific factors influence the occupancy of the trait-space?" These are good questions, but are not what the volume, density and position metrics actually capture. I would suggest rewording, or more explicitly state how these questions can be answered.)</p>

> We reworded the generic questions to correspond to what the size, density and position can actually capture:

*are groups occupying the same amount of trait space?
Do some groups have contain more species than others in the same amount of trait space?
Are some specific factors correlated to different patterns of occupancy of the trait space (e.g. are some factors correlated with more occupancy)?* lines @@@

<p style="color:blue">Some other thoughts the authors might want to consider (e.g., as additional discussion topics):</p>

> We agree with the reviewers' three points below but due to the restricted amount of words allowed for this manuscript we could unfortunately only add short caveats. Note that these exact three points are discussed in a review paper (still in prep.) where they are discussed in more details.

1. <p style="color:blue">At no point do the authors really discuss visualisation of spaces. E.g., why are these metrics important? Why can't workers simply make bivariate plots and interpet those? (There are good reasons, of course, but I think it would help to make these explicit to emphasise the need for this paper.)</p>

> We've added a note saying that trait space occupancy cannot be studied beyond 2 or 3 dimensions using bi/tri-variate techniques:

*Because of the multidimensional nature of these trait spaces, it is often not possible to study them use bi- or tri-variate techniques.* lines @@@

2. <p style="color:blue">Volume measures generally assume convexity (hypercubes, hyperellipsoids, ranges), but what if the point distributions are concave or have voids (inoccupiable "holes")? This seems like another consideration of what a good metric is that is currently not discussed. Concavities can also be artefactual features of some ordinations (e.g., the "horseshoeing" seen with some spaces).</p>

> We've added the following caveat for the size metrics:

*Size metrics do not take into account the distribution of the observations within a group and can be sensible to innocupied "holes" in it (Blonder et al. 2018).* lines@@@

3. <p style="color:blue">What about sampling considerations? I would imagine both density and range would be correlated with sample size, albeit negatively and positively respectively. I don't think the authors are obliged to solve this issue, but it is another consideration of what makes a "good" metric that could be discussed.</p>

> We've added the following caveats for the density metrics:

*Note that density based metrics can be sensitive to sampling*. lines @@@

## Other minor corrections:

* <p style="color:blue">L125 - "Paleogene" (spelling). NB: This is a name and hence there is not a formal UK- (palaeo-) versus US-spelling (paleo-) option here.</p>

> We fixed this typo.

* <p style="color:blue">L127 - "expand" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L152 - I applaud this approach over bombarding readers with information, but a brief note on why would be helpful (and what helped the ones in the main text make "the cut"; are these the most commonly used metrics?).</p>

> We chose these metrics because of their contrasted results and because the where the ones commonly used to represent size and position in the trait-space (expect for the average displacement). We've added a justification in the paper:

*Note that the paper contains the results for only height metrics which were selected as representative of common metrics covering the size, density and position trait-space aspects. However, the results for the additional 17 metrics is available in the supplementary material 4.*(line @@@)

* <p style="color:blue">L155-156 - Both the table and contents require more information to understand them. Currently I have to go into the main text to get even a basic idea of what size means, for example.</p>

> We expanded the table caption to:

*Table 2: different simulated space distribution.* Name *of the simulated space in this paper;* dimensions *of the matrix (row\*columns);* distribution(s) *of the data on each dimensions (for the 'Random' space, each dimension is randomly chosen to be Normal, Uniform or Lognormal);* dimension variance *:distribution of the variance between dimensions (when equal, the dimensions have the same variance, otherwise, the variance per dimensions is decreasing either lognormally (multiplicative) or normally (additive);* correlation *between dimensions.*(line @@@)

* <p style="color:blue">L165 - Missing \cite{} in TeX for healy?</p>

> We fixed this typo.

* <p style="color:blue">L167 - Isn't a correlation (i.e., co-linearity) between traits exactly what many ordination techniques use to reduce the dimensionality of the space? I.e., should they be correlated?</p>

> Ordination techniques (e.g. PCA) do indeed produce spaces with uncorrelated dimensions. We added this extra simulation parameters for the cases when trait-spaces where not ordinated and could thus contain some degree of co-linearity. We've specified this in the main text:

*Finally, we added a correlation parameter to take into account the potential correlation between different traits to illustrate the effect of co-linearity between traits (especially in non-ordinated trait-spaces).*(line @@@)

* <p style="color:blue">L173 - I suspect many of the attributions for these metrics are inaccurate, referring instead to later synthetic works. E.g., sum of variances or ranges certainly goes back to Foote 1992. I think the original authors should get their due here!</p>

> We've updated the attributions of the Sum of ranges and sum of variances to Foote 1992 as well as the Minimum Spanning tree distance to Sedgewick 1990.

* <p style="color:blue">L176 - "their" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L214 - Grammar.</p>

> We fixed this typo.

* <p style="color:blue">L215 - Surely you mean degree of overlap? It seems like you can say absolutely if they do overlap (p=1). Clarification would help.</p>

> We've changed "probability of overlap" to "amount of overlap" throughout the text.

* <p style="color:blue">L216 - This could do with being a bit more informative for what each panel means. Specifically, panel E is probably the most important as it will need to be understood for the results to come to make sense. I.e., what does an ideal plot look like? A worst case scenario?</p>

> We've modified figure 2 by showing a "worst" and "best" scenario (see above).

* <p style="color:blue">L227 - "a decrease in density can often lead to an increase in volume" Surely this depends on the metric. E.g., how could range increase if data are removed? It seems like this is also a consideration for whether a metric is doing a good job. </p>

> We apologise for this typo and meant that a **increase** in density (in a normal space) can lead to a **decrease** of size (not the opposite): when increasing density of point in a normal space, the points further away from the space (which occur at a lower denisty) could be removed which would thus decrease the size. More simply: tightening a space will reduce it's density (again, if the space is normally distributed). We've correct this error. 

* <p style="color:blue">L229 - Again, I think the correct citation for this is an older work.</p>

>We change the reference to Bellman 1957.

* <p style="color:blue">L234 - This seems like a failure of the metric not a hyperdimensionality issue. I.e., shouldn't a good metric capture an expansion regardless of the number of axes involved? Perhaps I am missing something here, but if I specifically think of sum of ranges in a fixed dimension space then increasing the range on any single axis will increase the overall sum.</p>

> The reviewer is totally correct here for the metric "sum of ranges", we here meant that the metric "hypervolume" (i.e. product of ranges) would decrease. We've clarified this in the manuscript:

*if a group expands in multiple dimensions (i.e. increase in size), the actual hypervolume <($\prod_{i}^{d} range_{Di}$) can decrease (line @@@)* (line @@@)

* <p style="color:blue">L245 - "were" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L262 - This Table/Figure is not as easy to interpret as the authors seem to think. I think it would help to show the ideal result for each case as a comparator.</p>

> We improved the table readability by editing Figure 2 as detailed in comment about L216 above.

* <p style="color:blue">L274 - "a change a clear change" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L276 - It should be much easier to identify what the groups are here.</p>

> We've added the groups names for each dataset in the table caption.

* <p style="color:blue">L282 - "except" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L318 - "values" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L342 - "### Caveats" A Markdown subheader without a line break?</p>

> We fixed this typo.

* <p style="color:blue">L346 - "accurately" Missing word? "reflect"?</p>

> We fixed this typo.

* <p style="color:blue">L358 - Missing "a"?</p>

> We fixed this typo.

* <p style="color:blue">L362 - "at" (grammar).</p>

> We fixed this typo.

* <p style="color:blue">L366 - I would actually argue the opposite here. "Disparity" is simply poorly defined, but density and volume have clear meanings. However, specific tests make sense too. In other words, a good use would be something like "We used sum of ranges to capture volume of space occupied".</p>

> We've changed the sentence to reflect the reviewer's opinion that we wholeheartedly agree with:

*Third, we suggest to not name metrics as the biological aspect they are describing which can be vague (e.g. "disparity" or "functional dispersion") but rather what they are measuring and why (e.g. "We used sum of ranges to capture the size of occupied space occupied").*(line @@@)

* <p style="color:blue">SI4, P3 - Plot seems to get cropped by bottom of page.</p>

>We've fixed this display bug.


























# Reviewer: 2

1. <p style="color:blue">Many statistical and mathematical terms are used imprecisely or incorrectly. For instance:
 * <p style="color:blue"> The term "metric" has a particular meaning in statistics and geometry, but the term is used more vaguely in the sense of "measure" here. </p>

 >@@@ Change metric to measure?

 * <p style="color:blue"> "Volume" is a clear geometric concept, but it is used here for all kinds of formulas. The product of lengths (ranges, standard deviations, inter-quartile distances) in orthogonal directions can indeed be interpreted as a volume, but Procrustes variance (l 61) cannot (this is a sum, not a product of variances). Also the example in Figure 1A is wrong: a sum of ranges is not a volume. Also in Table 3, the first two formulas, "average distance from centroid" (which should read "square root of summed squared distances from centroid") and "sum of variances", are not volumes (and, by the way, they are the same except for the root and the division by n; hence their correlation in the example).</p>

 >We have chosen to change our broad category "volume" to "size" to avoid confusion with the mathematical definition of volume.
 We have renamed the "average distance from centroid" to "average Euclidean distance from centroid".
 Also, the similarity between the average Euclidean distance from centroid is indeed expected but we thought we leave both in the main text of the manuscript since they are commonly used.


 * <p style="color:blue"> Likewise, the term "density" is used in a way that I fail to understand. In statistics, "probability density" is a standard concept that also applies to multivariate data spaces. Sometimes, "density" is used here to describe a variance, e.g. in Fig. 1B, but it is not clear why. Also I don't understand the description in l 103-110.</p>

 >Throughout the manuscript we use density in a more colloquial (or physical) way as suggest by the reviewer where density is an indication of the quantity of observations per units of size (volume, area, etc.): some trait-spaces can have the same size but contain different number of observations.
 In a sense, this can be linked to probability density since a high value (density) in a probability density function of a distribution corresponds to the parts of the distribution with a high number of observations.
 We have tried to make this clearer in our definition of the category of measurement:

 *Density metrics measure an indication of the quantity of observations in the trait space.
 They can be interpreted as the distribution of the observations* within *a group in the trait space.
 Groups with higher density have more observations within it (i.e. more observations per approximation of size) that will tend to be more similar to each other.
 For example, if group A is greater than group B and both have the same density (observations are equally distant within each group), similar mechanisms could be driving both groups' trait space occupancy.
 However, this might suggest that A is older and had more time to achieve more extreme trait combinations under essentially the same process [@endler2005].
 Note that density based metrics can be sensitive to sampling.
 Density is less commonly measured compared to size, but it is still used in both ecology [e.g. the minimum spanning tree length; @oksanen2007vegan] and evolution [e.g. the average pairwise distance; @geiger2008].* lines@@@



<!-- A - Size (e.g. sum of ranges); B - Arrangement (e.g. pairwise distances); C - Position (e.g. distances from centroid) -->


 >@@@ Use a synonym for density
 >We have chosen to change our broad category name from "density" to "arrangement" to avoid confusion with the mathematical definition of volume.



 * <p style="color:blue"> The concept of a "position" of a group in trait space is not clear throughout the manuscript. E.g., in Fig 1C, the median distance from the centroid is considered a "position", but it is just another measure of disparity/variance. And why should "position metrics be harder to interpret in multidimensional spaces" (l 115)? </p>

 >@@@ Define position better and add a general note that metrics, although they measure something precisely (e.g. variance) can be used to measure a specific aspect (e.g. position). Also maybe add a note that we do not embrace a restrictive term for disparity hence the low use of this world in the paper.

 * <p style="color:blue"> A data matrix is not yet a "space" (l 80). In addition to a set of elements, a mathematical space requires some relations between the elements, such as a metric or nearness relationship (for assessable discussions of mathematical spaces in biology see, e.g., Stadler et al. 2002 J Theor Biol, Mitteroecker & Huttegger 2009 Biol Theory).</p>

 >@@@ Not sure I agree with this definition but see the references.

 * <p style="color:blue"> What is a "random" distribution, as opposed to a normal or uniform distribution (e.g., l 160)?</p>

 >@@@ TODO: fix this in the text

2. <p style="color:blue">I find the statement/conclusion "no one metric describes all of trait-space" somewhat trivial. Also, it is pretty clear that a measure of variance/disparity does not inform about the mean or central tendency; one does not need a simulation for this insight. If one cares about a single measure that captures group differences in both mean and variance (e.g., to assess group overlap), one should use appropriate statistics, such as Mahalanobis distance, Fisher information metric, Bhattacharrya coefficient (which the authors cite in a different context), or one of the many others derived from them.</p>

>@@@ We do agree that the conclusion (and the topic) of this paper are trivial. This was also highlighted by reviewer 1. However, as reviewer 1 also highlight: "@@@This is unfortunately rarely understood". Using the appropriate measurement and the appropriate statistical test to answer a specific biological question can seem trivial to many biologists (and should be!) be the literature unfortunately shows that not stating obvious and trivial things can often lead to incomprehensions or inaccuracies. Through this paper, we aim to propose and somewhat different vision of disparity metrics that we believe could be more intuitive for some researchers (e.g. using moms) and would help them using this for doing proper science (which is a them of MEE@@@?).
Finally, we are not sure how this comment helps improving the quality of the manuscript, at the contrary of all the other useful comments from this reviewer.

3. <p style="color:blue">The brief discussion of the "curse of dimensionality" is interesting and could be extended, as this is relevant for many modern datasets. However, the statement about the "probability of two points A and B overlapping in n dimensions" is inappropriate, as this probability is zero for continuous variables, regardless of dimension.</p>

>@@@ Improve + fix discussion about curse.

4. <p style="color:blue">I miss a discussion of how the measurement scales of the variables can influence the described statistics. I seems that all the variables are assumed to have an interval scale, for some statistics also a ratio scale. Is this realistic? Also nothing is mentioned about the topology of the multivariate data spaces: Do the spaces need to be metric or even Euclidean? Do the units and scales of the variables all need to be the same?</p>

>@@@ This makes me think Emma reviewed the paper.
>@@@ See comment from reviewer 1 about the precision about the euclidean and isotropic space properties. Units needs to be the same (I think) and scale is probably only important for visualisation (e.g. if the range of the first axis is 1e10 and the second axis 1e-10 with the same unit, the first axis will contain the overwhelming majority of information but both can be used without scaling - while plotting the space however, if both axis are not scaled, the results will be highly missleading - i.e. letting the reader think that there is some important variation going on on the second axis, relative to the first one.)

```{r, eval = FALSE}
## A small trait space with a huge scale different per axis
space <- cbind(rnorm(10, sd = 1e3), rnorm(10, sd = 1e-3))
## Operations discussed in this paper on the space are valid
## However, representing without scaling the axis is missleading
plot(space)
## Since the real space looks like this
plot(space, xlim = c(-1.5e3, 1.5e3), ylim = c(-1.5e3, 1.5e3))
```

5. <p style="color:blue">The different statistics were evaluated and compared across datasets with different dimensionalities and distributions. While this seems feasible, the computation of p-values by ANOVA is not. This is not a question of type I error as you are not testing against sampling variation. In other words, you treat each dataset as a case drawn independently from the same distribution of datasets. Clearly, this is not what you are doing.</p>

>@@@ Fix this problem


### Minor comments

* <p style="color:blue">The term "trait space" does not need to be hyphenated.</p>

> We removed the hyphen throughout the manuscript.

* <p style="color:blue">line 11: "a subset of this trait-space" Either a "subset of this set" or a "subspace of this space" </p>

> We changed it to:

*a subspace of this space* (line @@@)

* <p style="color:blue">l 39: typo "used"</p>

> We fixed this typo.

* <p style="color:blue"> 175: "eigenvalue" is a single word</p>

> We fixed this typo.

* <p style="color:blue">Table 3:  the formula for "average nearest neighbourhood distance" does not seem correct to me; last line, right column: what is a "centre of trait space"? </p>

> We fixed the average nearest neighbour distance and specified the coordinates of the trait space (0, 0, ...)
@@@TODO: check nearest neigbhour formula

* <p style="color:blue">Table 5: A p-value cannot be 0.</p>

> We changed our p-value rounding to display p-values rounded to 0 as <1e-3.
